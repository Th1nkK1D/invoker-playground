(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{166:function(e,t){},178:function(e){e.exports=JSON.parse('{"space":32,"q":81,"w":87,"e":69,"r":82}')},180:function(e,t,n){"use strict";var s=n(166),i=n.n(s);t.default=i.a},181:function(e,t,n){"use strict";n.r(t);n(165),n(71),n(45),n(25),n(76),n(170),n(171),n(172);var s,i=n(68),r=n(173),a=n.n(r),l=(n(174),n(175),n(167)),o=n(163),c=n(164),u=function(){function e(t,n){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Object(o.a)(this,e),this.name=t,this.icon=s,this.requiredOrbs=e.sortOrbs(n)}return Object(c.a)(e,null,[{key:"sortOrbs",value:function(e){return Object(l.a)(e).sort((function(e,t){return e.key.localeCompare(t.key)}))}}]),Object(c.a)(e,[{key:"isFulFilledWith",value:function(t){var n=this;return e.sortOrbs(t).every((function(e,t){return e.isEqualTo(n.requiredOrbs[t])}))}},{key:"isEqualTo",value:function(e){return e&&e.name&&e.name===this.name}}]),e}(),h={name:"SpellBar",props:{spell:u}},d=n(30),p=Object(d.a)(h,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex flex-row bg-white h-12 max-w-md m-auto rounded-full p-1 shadow-md"},[e.spell?n("img",{staticClass:"h-full rounded-full",attrs:{src:e.spell.icon,alt:e.spell.name,role:"img"}}):e._e(),n("div",{staticClass:"text-black flex-1 flex flex-col justify-center font-bold"},[e._v("\n    "+e._s(e.spell?e.spell.name:"Press space to start")+"\n  ")]),e.spell?n("div",{staticClass:"w-10"}):e._e()])}),[],!1,null,null,null).exports,f=(n(33),n(75),n(176),n(177)),b=function(){function e(t){Object(o.a)(this,e),this.activeOrbs=[null,null,null],this.spells=t}return Object(c.a)(e,[{key:"castOrb",value:function(e){var t=Object(f.a)(this.activeOrbs).slice(1);this.activeOrbs=[].concat(Object(l.a)(t),[e])}},{key:"invoke",value:function(){var e=this;return this.activeOrbs.some((function(e){return null===e}))?null:this.spells.find((function(t){return t.isFulFilledWith(e.activeOrbs)}))}}]),e}(),m=n(178),v=n(169),O=n(179),k=n.n(O),y=function(){function e(t,n){var s;Object(o.a)(this,e),this.scene=new v.Scene,this.loader=new k.a,this.renderer=new v.WebGLRenderer,this.renderer.setSize(t,n),this.clock=new v.Clock,this.invokerAnimationMixer=null,this.invokerAnimationClips=[],this.orbs=[new v.Object3D,new v.Object3D,new v.Object3D],this.orbs[0].position.setX(-3).setY(4).setZ(-1),this.orbs[1].position.setX(0).setY(7.5).setZ(-1),this.orbs[2].position.setX(3).setY(4).setZ(-1),(s=this.scene).add.apply(s,Object(l.a)(this.orbs)),this.nextOrbIndex=0,this.nextCastedHand="l"}return Object(c.a)(e,[{key:"render",value:function(e){var t=this;this.loader.load("".concat("/invoker-playground","/models/invoker.glb"),(function(n){var s;(s=t.scene).add.apply(s,Object(l.a)(n.scene.children));var r=Object(i.a)(n.cameras,1);t.camera=r[0],t.invokerAnimationClips=n.animations,t.invokerAnimationMixer=new v.AnimationMixer(t.scene.getObjectByName("invoker")),t.getAnimationAction("idle").play(),e.appendChild(t.renderer.domElement),t.animate()}))}},{key:"animate",value:function(){var e=this;requestAnimationFrame((function(){return e.animate()})),null!==this.invokerAnimationMixer&&this.invokerAnimationMixer.update(this.clock.getDelta()),this.renderer.render(this.scene,this.camera)}},{key:"pushOrb",value:function(e){this.getAnimationAction("cast_".concat(this.nextCastedHand)).stop().setLoop(v.LoopOnce).play();var t=this.orbs[this.nextOrbIndex];t.children&&t.children.pop(),t.add(new v.Mesh(new v.SphereGeometry(.5),new v.MeshBasicMaterial({color:{q:43775,w:12541951,e:16755200}[e]}))),this.nextOrbIndex=(this.nextOrbIndex+1)%3,this.nextCastedHand="l"===this.nextCastedHand?"r":"l"}},{key:"invoke",value:function(){this.getAnimationAction("invoke").stop().setLoop(v.LoopOnce).play()}},{key:"getAnimationAction",value:function(e){return this.invokerAnimationMixer.clipAction(v.AnimationClip.findByName(this.invokerAnimationClips,e))}}]),e}(),x={name:"ModelScene",data:function(){return{sceneController:null}},mounted:function(){this.sceneController=new y(500,500),this.sceneController.render(this.$refs.scene)},methods:{pushOrb:function(e){this.sceneController.pushOrb(e.key)},invoke:function(){this.sceneController.invoke()}}},w=Object(d.a)(x,(function(){var e=this.$createElement;return(this._self._c||e)("div",{ref:"scene",staticClass:"flex justify-center"})}),[],!1,null,null,null).exports,g={name:"GameArea",components:{SpellBar:p,Keypress:a.a,ModelScene:w},props:{orbs:{type:Array,default:function(){return[]}},spells:{type:Array,default:function(){return[]}}},data:function(){return{watchedKeys:[{code:m.space,handler:this.onStartPressed},{code:m.q,handler:this.onOrbPressed},{code:m.w,handler:this.onOrbPressed},{code:m.e,handler:this.onOrbPressed},{code:m.r,handler:this.onInvokePressed}],targetSpell:null}},computed:{isStarted:function(){return null!==this.targetSpell}},methods:{getNextTargetSpell:function(){var e=this,t=this.spells.filter((function(t){return t!==e.targetSpell})),n=Math.floor(Math.random()*t.length),s=t.splice(n,1),r=Object(i.a)(s,1);this.targetSpell=r[0]},onStartPressed:function(){this.isStarted||(s=new b(this.spells),this.getNextTargetSpell())},onOrbPressed:function(e){if(this.isStarted){var t=Object.keys(m).find((function(t){return m[t]===e})),n=this.orbs.find((function(e){return e.key===t}));s.castOrb(n),this.$refs.modelScene.pushOrb(n)}},onInvokePressed:function(){if(this.isStarted){var e=s.invoke();this.$refs.modelScene.invoke(),e&&e.isEqualTo(this.targetSpell)&&this.getNextTargetSpell()}}}},j=Object(d.a)(g,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("ModelScene",{ref:"modelScene"}),t("SpellBar",{attrs:{"data-testId":"spellBar",spell:this.targetSpell}}),this._l(this.watchedKeys,(function(e){return t("Keypress",{key:e.code,attrs:{"key-code":e.code,event:"keydown"},on:{pressed:e.handler}})}))],2)}),[],!1,null,null,null).exports,S=function(){function e(t,n){Object(o.a)(this,e),this.name=t,this.key=n}return Object(c.a)(e,[{key:"isEqualTo",value:function(e){var t=e.key;return this.key===t}}]),e}(),A={metaInfo:{title:"Invoker Playground"},components:{GameArea:j},data:function(){return{orbs:[],spells:[]}},mounted:function(){var e=this;this.orbs=this.$page.orbs.edges[0].node.data.map((function(e){var t=e.name,n=e.key;return new S(t,n)})),this.spells=this.$page.spells.edges[0].node.data.map((function(t){var n=t.name,s=t.requiredOrbs,i=t.icon;return new u(n,s.split("").map((function(t){return e.orbs.find((function(e){return e.key===t}))})),i)}))}},C=n(180),M=Object(d.a)(A,(function(){var e=this.$createElement,t=this._self._c||e;return t("Layout",[t("div",{staticClass:"h-full flex flex-col justify-center text-center text-white"},[t("GameArea",{attrs:{orbs:this.orbs,spells:this.spells}})],1)])}),[],!1,null,null,null);"function"==typeof C.default&&Object(C.default)(M);t.default=M.exports}}]);